<Window x:Class="GravityDamAnalysis.UI.Views.ProfileValidationWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="二维剖面验证" Width="1400" Height="900"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <!-- 自定义样式 -->
        <Style x:Key="ToolPanelStyle" TargetType="Border">
            <Setter Property="BorderBrush" Value="LightGray"/>
            <Setter Property="BorderThickness" Value="0,0,1,0"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Padding" Value="16"/>
        </Style>
        
        <Style x:Key="ValidationItemStyle" TargetType="Border">
            <Setter Property="BorderBrush" Value="LightGray"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>
        
        <Style x:Key="IssueSeverityStyle" TargetType="Ellipse">
            <Setter Property="Width" Value="8"/>
            <Setter Property="Height" Value="8"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
        </Style>
        
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*"/>  <!-- 主视图区域 -->
            <ColumnDefinition Width="1*"/>  <!-- 控制面板 -->
        </Grid.ColumnDefinitions>
        
        <!-- 主绘制区域 -->
        <Border Grid.Column="0" Style="{StaticResource ToolPanelStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- 工具栏 -->
                <Border Grid.Row="0" Background="#F5F5F5" Padding="12,8">
                    <StackPanel Orientation="Horizontal">
                        <Button Content="缩放适应" ToolTip="缩放适应视图" Margin="4,0"/>
                        <Button Content="平移" ToolTip="平移视图" Margin="4,0"/>
                        <Button Content="选择" ToolTip="选择几何元素" Margin="4,0"/>
                        
                        <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="8,0"/>
                        
                        <Button Content="测量" ToolTip="测量距离" Margin="4,0"/>
                        <Button Content="标注" ToolTip="添加标注" Margin="4,0"/>
                        
                        <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="8,0"/>
                        
                        <TextBlock Text="缩放:" VerticalAlignment="Center" Margin="8,0"/>
                        <ComboBox Width="80" SelectedIndex="2" Margin="4,0">
                            <ComboBoxItem Content="25%"/>
                            <ComboBoxItem Content="50%"/>
                            <ComboBoxItem Content="100%"/>
                            <ComboBoxItem Content="150%"/>
                            <ComboBoxItem Content="200%"/>
                        </ComboBox>
                    </StackPanel>
                </Border>
                
                <!-- 绘图画布 -->
                <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1" Margin="8">
                    <Canvas x:Name="DrawingCanvas" Background="White">
                        <!-- 这里将通过代码动态绘制剖面图形 -->
                        
                        <!-- 示例：坝体轮廓 -->
                        <Polygon Canvas.Left="100" Canvas.Top="100" 
                                  Points="0,0 200,0 180,50 160,80 140,100 120,120 100,140 80,160 60,180 40,200 20,220 0,240"
                                  Stroke="Black" StrokeThickness="2" Fill="LightBlue" Opacity="0.3"/>
                        
                        <!-- 示例：基础线 -->
                        <Line Canvas.Left="100" Canvas.Top="340" 
                              X1="0" Y1="0" X2="200" Y2="0"
                              Stroke="Brown" StrokeThickness="3"/>
                        
                        <!-- 示例：水位线 -->
                        <Line Canvas.Left="100" Canvas.Top="120" 
                              X1="0" Y1="0" X2="200" Y2="0"
                              Stroke="Blue" StrokeThickness="2" StrokeDashArray="5,5"/>
                        
                        <!-- 示例：标注 -->
                        <TextBlock Canvas.Left="110" Canvas.Top="110" Text="上游水位" 
                                   FontSize="10" Foreground="Blue"/>
                        <TextBlock Canvas.Left="110" Canvas.Top="350" Text="基础线" 
                                   FontSize="10" Foreground="Brown"/>
                    </Canvas>
                </Border>
                
                <!-- 状态栏 -->
                <Border Grid.Row="2" Background="#F5F5F5" Padding="12,4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="就绪 - 点击几何元素进行编辑" 
                                   VerticalAlignment="Center"/>
                        
                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                            <TextBlock Text="坐标:" VerticalAlignment="Center" Margin="0,0,4,0"/>
                            <TextBlock Text="X: 0.00, Y: 0.00" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>
        
        <!-- 控制面板 -->
        <Border Grid.Column="1" Style="{StaticResource ToolPanelStyle}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <!-- 剖面信息 -->
                    <TextBlock Text="剖面信息" Style="{StaticResource HeaderStyle}"/>
                    
                    <Border Style="{StaticResource ValidationItemStyle}">
                        <StackPanel>
                            <TextBlock Text="剖面名称" FontSize="12" Foreground="Gray"/>
                            <TextBlock Text="{Binding ProfileName}" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource ValidationItemStyle}">
                        <StackPanel>
                            <TextBlock Text="提取状态" FontSize="12" Foreground="Gray"/>
                            <TextBlock Text="{Binding ExtractionStatus}" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource ValidationItemStyle}">
                        <StackPanel>
                            <TextBlock Text="几何特征" FontSize="12" Foreground="Gray"/>
                            <ItemsControl ItemsSource="{Binding GeometryFeatures}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="0,2">
                                            <Ellipse Style="{StaticResource IssueSeverityStyle}" Fill="Blue"/>
                                            <TextBlock Text="{Binding Name}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                    
                    <!-- 验证问题 -->
                    <TextBlock Text="验证问题" Style="{StaticResource HeaderStyle}" Margin="0,16,0,12"/>
                    
                    <ItemsControl ItemsSource="{Binding ValidationIssues}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ValidationItemStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                            <Ellipse Style="{StaticResource IssueSeverityStyle}" Fill="Red"/>
                                            <TextBlock Text="{Binding Type}" FontWeight="SemiBold"/>
                                        </StackPanel>
                                        <TextBlock Text="{Binding Description}" TextWrapping="Wrap"/>
                                        <Button Content="修复" 
                                                HorizontalAlignment="Right" Margin="0,4,0,0"
                                                Command="{Binding DataContext.FixIssueCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                CommandParameter="{Binding}"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    
                    <!-- 边界条件 -->
                    <TextBlock Text="边界条件" Style="{StaticResource HeaderStyle}" Margin="0,16,0,12"/>
                    
                    <ItemsControl ItemsSource="{Binding BoundaryConditions}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Style="{StaticResource ValidationItemStyle}">
                                    <StackPanel>
                                        <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                                        <TextBlock Text="{Binding Value}"/>
                                        <CheckBox Content="已确认" 
                                                  IsChecked="{Binding IsConfirmed}"
                                                  Margin="0,4,0,0"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    
                    <!-- 操作按钮 -->
                    <StackPanel Margin="0,16,0,0">
                        <Button Content="确认验证" 
                                Command="{Binding ConfirmValidationCommand}"
                                Margin="0,0,0,8" Padding="12,6"/>
                        
                        <Button Content="重新提取" 
                                Command="{Binding ReExtractCommand}"
                                Margin="0,0,0,8" Padding="12,6"/>
                        
                        <Button Content="导出剖面" 
                                Command="{Binding ExportProfileCommand}"
                                Margin="0,0,0,8" Padding="12,6"/>
                        
                        <Button Content="取消" 
                                Command="{Binding CancelCommand}"
                                Padding="12,6"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</Window> 