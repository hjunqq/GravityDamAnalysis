<Window x:Class="GravityDamAnalysis.UI.Views.ProfileExtractionConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="剖面提取配置" Height="600" Width="800"
        WindowStartupLocation="CenterOwner"
        Background="WhiteSmoke"
        FontFamily="Segoe UI">
    
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Themes/StandardWpfTheme.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- 转换器定义 -->
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        </ResourceDictionary>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题区域 -->
        <TextBlock Grid.Row="0" Text="剖面提取配置" 
                   Style="{StaticResource Headline4TextBlock}"/>
        
        <!-- 配置内容区域 -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                
                <!-- 坝体选择区域 -->
                <Border Style="{StaticResource CardBorder}">
                    <StackPanel>
                        <TextBlock Text="坝体选择" Style="{StaticResource Headline6TextBlock}"/>
                        <DataGrid x:Name="DamSelectionGrid" 
                                  ItemsSource="{Binding AvailableDams}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  Height="150">
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="选择" Binding="{Binding IsSelected}" Width="60"/>
                                <DataGridTextColumn Header="坝体名称" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="高度(m)" Binding="{Binding Height}" Width="80"/>
                                <DataGridTextColumn Header="类型" Binding="{Binding Type}" Width="80"/>
                                <DataGridTextColumn Header="材料" Binding="{Binding Material}" Width="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </Border>
                
                <!-- 剖面配置区域 -->
                <Border Style="{StaticResource CardBorder}">
                    <StackPanel>
                        <TextBlock Text="剖面配置" Style="{StaticResource Headline6TextBlock}"/>
                        
                        <!-- 剖面数量和位置 -->
                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                <TextBlock Text="剖面数量" Margin="0,0,0,5"/>
                                <Slider x:Name="ProfileCountSlider" 
                                        Minimum="1" Maximum="10" Value="{Binding ProfileCount}"
                                        TickFrequency="1" IsSnapToTickEnabled="True"/>
                                <TextBlock Text="{Binding ElementName=ProfileCountSlider, Path=Value, StringFormat={}{0:F0} 个剖面}" 
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                <TextBlock Text="剖面分布方式" Margin="0,0,0,5"/>
                                <ComboBox x:Name="DistributionTypeCombo" SelectedIndex="0">
                                    <ComboBoxItem Content="均匀分布"/>
                                    <ComboBoxItem Content="关键位置"/>
                                    <ComboBoxItem Content="自定义位置"/>
                                </ComboBox>
                            </StackPanel>
                        </Grid>
                        
                        <!-- 提取选项 -->
                        <TextBlock Text="提取选项" Margin="0,10,0,5" FontWeight="Bold"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <CheckBox x:Name="ExtractFoundationChk" Content="提取基础线" IsChecked="True" Margin="0,0,20,0"/>
                            <CheckBox x:Name="ExtractMaterialZonesChk" Content="提取材料分区" IsChecked="True" Margin="0,0,20,0"/>
                            <CheckBox x:Name="ExtractDrainageChk" Content="提取排水系统" IsChecked="False"/>
                        </StackPanel>
                        
                        <!-- 精度设置 -->
                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                <TextBlock Text="几何精度" Margin="0,0,0,5"/>
                                <ComboBox x:Name="GeometricAccuracyCombo" SelectedIndex="1">
                                    <ComboBoxItem Content="粗糙 (0.1m)"/>
                                    <ComboBoxItem Content="标准 (0.01m)"/>
                                    <ComboBoxItem Content="精细 (0.001m)"/>
                                </ComboBox>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                <TextBlock Text="网格密度" Margin="0,0,0,5"/>
                                <ComboBox x:Name="MeshDensityCombo" SelectedIndex="1">
                                    <ComboBoxItem Content="稀疏"/>
                                    <ComboBoxItem Content="标准"/>
                                    <ComboBoxItem Content="密集"/>
                                </ComboBox>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- 输出设置区域 -->
                <Border Style="{StaticResource CardBorder}">
                    <StackPanel>
                        <TextBlock Text="输出设置" Style="{StaticResource Headline6TextBlock}"/>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <CheckBox x:Name="SaveToDatabaseChk" Content="保存到数据库" IsChecked="True" Margin="0,0,20,0"/>
                            <CheckBox x:Name="ExportToDwgChk" Content="导出为DWG" IsChecked="False" Margin="0,0,20,0"/>
                            <CheckBox x:Name="GenerateReportChk" Content="生成报告" IsChecked="True"/>
                        </StackPanel>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" Text="输出路径:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <TextBox Grid.Column="1" x:Name="OutputPathTextBox" 
                                     Text="{Binding OutputPath}" 
                                     Margin="0,0,10,0"/>
                            <Button Grid.Column="2" Content="浏览..." 
                                    Click="BrowseOutputPath_Click" 
                                    Padding="12,6" BorderThickness="1"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
        
        <!-- 进度区域 -->
        <StackPanel Grid.Row="2" Margin="0,10,0,10" Visibility="{Binding IsExtracting, Converter={StaticResource BooleanToVisibilityConverter}}">
            <TextBlock Text="{Binding ExtractionStatus}" Margin="0,0,0,5"/>
            <ProgressBar Value="{Binding ExtractionProgress}" Height="6"/>
        </StackPanel>
        
        <!-- 按钮区域 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button x:Name="PreviewButton" Content="预览" 
                    Click="Preview_Click"
                    Padding="12,8" BorderThickness="1" 
                    Margin="0,0,10,0" Width="80"/>
            <Button x:Name="ExtractButton" Content="开始提取" 
                    Click="Extract_Click"
                    Background="DodgerBlue" Foreground="White" Padding="12,8"
                    Margin="0,0,10,0" Width="100"/>
            <Button x:Name="CancelButton" Content="取消" 
                    Click="Cancel_Click"
                    Padding="12,8" BorderThickness="1" 
                    Width="80"/>
        </StackPanel>
    </Grid>
</Window> 