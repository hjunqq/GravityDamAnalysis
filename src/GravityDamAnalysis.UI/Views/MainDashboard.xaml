<Window x:Class="GravityDamAnalysis.UI.Views.MainDashboard"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="重力坝稳定性分析 - 主控制台" Height="600" Width="800"
        WindowStartupLocation="CenterScreen">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题和状态 -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="重力坝稳定性分析系统" FontSize="24" FontWeight="Bold" Margin="0,0,0,10"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" FontSize="14" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" Text="连接状态:" FontSize="12" Margin="20,0,5,0" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="2" Text="{Binding ConnectionStatus}" FontSize="12" FontWeight="Bold" VerticalAlignment="Center"/>
            </Grid>
        </StackPanel>
        
        <!-- 进度条 -->
        <ProgressBar Grid.Row="1" Height="20" Margin="0,0,0,10" 
                     Value="{Binding ProgressValue}" 
                     Visibility="{Binding IsProgressVisible, Converter={StaticResource BooleanToVisibilityConverter}}"/>
        
        <!-- 主要内容 -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- 左侧：操作面板 -->
            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                <TextBlock Text="操作面板" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                
                <Button Content="自动识别坝体" Height="40" Margin="0,5" 
                        Command="{Binding AutoDetectDamsCommand}"/>
                <Button Content="提取剖面" Height="40" Margin="0,5" 
                        Command="{Binding ExtractProfilesCommand}" Click="Button_Click"/>
                <Button Content="稳定性分析" Height="40" Margin="0,5" 
                        Command="{Binding StabilityAnalysisCommand}"/>
                <Button Content="生成报告" Height="40" Margin="0,5" 
                        Command="{Binding GenerateReportCommand}"/>
                
                <TextBlock Text="分析状态:" FontSize="12" FontWeight="Bold" Margin="0,20,0,5"/>
                <TextBlock Text="{Binding AnalysisStatus}" FontSize="12" Margin="0,0,0,10"/>
                
                <TextBlock Text="项目信息:" FontSize="12" FontWeight="Bold" Margin="0,10,0,5"/>
                <TextBlock Text="{Binding CurrentProject.Name}" FontSize="11" Margin="0,2"/>
                <TextBlock Text="{Binding CurrentProject.Number}" FontSize="11" Margin="0,2"/>
                <TextBlock Text="{Binding CurrentProject.Location}" FontSize="11" Margin="0,2"/>
            </StackPanel>
            
            <!-- 右侧：数据显示 -->
            <StackPanel Grid.Column="1" Margin="10,0,0,0">
                <TextBlock Text="识别到的坝体" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                <ListBox ItemsSource="{Binding DetectedDams}" Height="150" Margin="0,0,0,20">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="5">
                                <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                <TextBlock Text="{Binding Type}" FontSize="11"/>
                                <TextBlock Text="{Binding Height, StringFormat='高度: {0:F1}m'}" FontSize="11"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                
                <TextBlock Text="最近分析结果" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                <ListBox ItemsSource="{Binding RecentAnalysisResults}" Height="150">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="5">
                                <TextBlock Text="{Binding ProfileId}" FontWeight="Bold"/>
                                <TextBlock Text="{Binding SlidingSafetyFactor, StringFormat='抗滑安全系数: {0:F2}'}" FontSize="11"/>
                                <TextBlock Text="{Binding SlidingStatus}" FontSize="11"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
        </Grid>
        
        <!-- 底部状态栏 -->
        <StatusBar Grid.Row="3" Margin="0,10,0,0">
            <StatusBarItem>
                <TextBlock Text="{Binding LastUpdateTime, StringFormat='最后更新: {0:yyyy-MM-dd HH:mm:ss}'}"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window> 