# é‡åŠ›åæŠ—æ»‘ç¨³å®šè®¡ç®—ä»£ç å®¡æŸ¥æŠ¥å‘Š

## ğŸ“‹ å®¡æŸ¥æ¦‚è¿°

**å®¡æŸ¥å¯¹è±¡**ï¼š`GravityDamAnalysis.Calculation` é¡¹ç›®ä¸­çš„æŠ—æ»‘ç¨³å®šè®¡ç®—æ¨¡å—  
**å®¡æŸ¥æ—¥æœŸ**ï¼š2024å¹´  
**å®¡æŸ¥é‡ç‚¹**ï¼šå·¥ç¨‹è®¡ç®—å…¬å¼çš„æ­£ç¡®æ€§ä¸è§„èŒƒç¬¦åˆæ€§  
**å®¡æŸ¥ç»“æœ**ï¼šå‘ç°å¤šé¡¹å…³é”®è®¡ç®—é”™è¯¯ï¼Œå·²æä¾›ä¿®æ­£æ–¹æ¡ˆ

## âŒ å‘ç°çš„ä¸»è¦é—®é¢˜

### 1. æŠ—æ»‘ç¨³å®šå…¬å¼å®ç°é”™è¯¯ (ä¸¥é‡)

**é—®é¢˜ä½ç½®**ï¼š`StabilityAnalysisService.cs:85-100`

**åŸå§‹é”™è¯¯ä»£ç **ï¼š
```csharp
// å‚ç›´åŠ›ï¼ˆè‡ªé‡å‡å»æ‰¬å‹åŠ›çš„å‚ç›´åˆ†é‡ï¼‰
double verticalForce = selfWeight;  // âŒ æœªå‡å»æ‰¬å‹åŠ›

// æŠ—æ»‘åŠ›
double resistingForce = damEntity.MaterialProperties.FrictionCoefficient * verticalForce;
```

**é—®é¢˜åˆ†æ**ï¼š
- âŒ å‚ç›´åŠ›è®¡ç®—ä¸­æœªè€ƒè™‘æ‰¬å‹åŠ›çš„å½±å“
- âŒ è¿åäº†é‡åŠ›åç¨³å®šåˆ†æçš„åŸºæœ¬åŸç†
- âš ï¸ ä¼šå¯¼è‡´è®¡ç®—ç»“æœåäºå±é™©ï¼Œå¯èƒ½é€ æˆå·¥ç¨‹å®‰å…¨éšæ‚£

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
```csharp
// æœ‰æ•ˆæ³•å‘åŠ›ï¼šè‡ªé‡å‡å»æ‰¬å‹åŠ› (kN)
double effectiveNormalForce = selfWeight - upliftForce;

// æŠ—æ»‘åŠ›ï¼šæ‘©æ“¦ç³»æ•° Ã— æœ‰æ•ˆæ³•å‘åŠ› (kN)  
double resistingForce = damEntity.MaterialProperties.FrictionCoefficient * effectiveNormalForce;
```

### 2. æ°´å‹åŠ›è®¡ç®—å…¬å¼é”™è¯¯ (ä¸¥é‡)

**é—®é¢˜ä½ç½®**ï¼š`StabilityAnalysisService.cs:258-264`

**åŸå§‹é”™è¯¯ä»£ç **ï¼š
```csharp
private double CalculateWaterPressure(AnalysisParameters parameters)
{
    double waterHeight = parameters.UpstreamWaterLevel - parameters.DownstreamWaterLevel;
    double waterPressure = 0.5 * parameters.WaterDensity * waterHeight * waterHeight * 1000; // âŒ
    return waterPressure;
}
```

**é—®é¢˜åˆ†æ**ï¼š
- âŒ å…¬å¼ä¸­ä½¿ç”¨äº†é”™è¯¯çš„æ°´å¤´å·®æ¦‚å¿µ
- âŒ å•ä½è½¬æ¢ä¸æ­£ç¡®ï¼ˆä¹˜ä»¥1000ï¼‰
- âŒ æ²¡æœ‰åˆ†åˆ«è®¡ç®—ä¸Šä¸‹æ¸¸æ°´å‹åŠ›
- âŒ ç¼ºå°‘ä½œç”¨é¢ç§¯çš„è€ƒè™‘

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
```csharp
private double CalculateWaterPressure(AnalysisParameters parameters)
{
    // ä¸Šæ¸¸æ°´å‹åŠ›åˆåŠ› P1 = 0.5 * Î³w * H1Â² (kN/m)
    double upstreamPressure = 0.5 * parameters.WaterDensity * 
                             parameters.UpstreamWaterLevel * parameters.UpstreamWaterLevel;
    
    // ä¸‹æ¸¸æ°´å‹åŠ›åˆåŠ› P2 = 0.5 * Î³w * H2Â² (kN/m)  
    double downstreamPressure = 0.5 * parameters.WaterDensity * 
                               parameters.DownstreamWaterLevel * parameters.DownstreamWaterLevel;
    
    // å‡€æ°´å‹åŠ› (kN/m)
    return Math.Max(0, upstreamPressure - downstreamPressure);
}
```

### 3. æ‰¬å‹åŠ›è®¡ç®—ä¸å®Œæ•´ (ä¸­ç­‰)

**é—®é¢˜ä½ç½®**ï¼š`StabilityAnalysisService.cs:274-281`

**åŸå§‹é”™è¯¯ä»£ç **ï¼š
```csharp
result.UpliftForce = parameters.UpliftReductionFactor * parameters.WaterDensity * 
                   parameters.UpstreamWaterLevel * baseArea * 1000; // âŒ åªè€ƒè™‘ä¸Šæ¸¸æ°´ä½
```

**é—®é¢˜åˆ†æ**ï¼š
- âŒ æ‰¬å‹åŠ›åˆ†å¸ƒåº”è€ƒè™‘ä¸Šä¸‹æ¸¸æ°´ä½å·®
- âŒ å•ä½è½¬æ¢ä¸å¿…è¦ï¼ˆå·²ç»æ˜¯kN/mÂ³ï¼‰

**ä¿®æ­£æ–¹æ¡ˆ**ï¼š
```csharp
// å¹³å‡æ‰¬å‹åŠ›æ°´å¤´ (è€ƒè™‘ä¸Šä¸‹æ¸¸æ°´ä½å·®çš„çº¿æ€§åˆ†å¸ƒ)
double averageUpliftHead = (upstreamWaterLevel + downstreamWaterLevel) / 2;

// æ‰¬å‹åŠ› = æŠ˜å‡ç³»æ•° Ã— å¹³å‡æ°´å¤´ Ã— åº•é¢ç§¯ Ã— æ°´é‡åº¦ (kN)
double upliftForce = upliftReductionFactor * averageUpliftHead * baseArea * waterDensity;
```

### 4. å•ä½æ··ä¹±é—®é¢˜ (ä¸­ç­‰)

**é—®é¢˜æè¿°**ï¼š
- åä½“è‡ªé‡è®¡ç®—ä¸­ä¸å¿…è¦åœ°ä¹˜ä»¥9.81
- æ°´å‹åŠ›è®¡ç®—ä¸­å•ä½è½¬æ¢é”™è¯¯
- ææ–™å¯†åº¦å·²ç»æ˜¯kN/mÂ³ï¼Œä¸éœ€è¦é¢å¤–è½¬æ¢

**ä¿®æ­£æªæ–½**ï¼š
- ç»Ÿä¸€ä½¿ç”¨kNä½œä¸ºåŠ›çš„å•ä½
- æ˜ç¡®æ³¨é‡Šå„å˜é‡çš„å•ä½
- ç§»é™¤ä¸å¿…è¦çš„å•ä½è½¬æ¢ç³»æ•°

## âœ… ä¿®æ­£åçš„æ­£ç¡®å®ç°

### ä¸»è¦è®¡ç®—æ–¹æ³•ä¿®æ­£

```csharp
/// <summary>
/// è®¡ç®—æŠ—æ»‘ç¨³å®šå®‰å…¨ç³»æ•°
/// æ ¹æ®ã€Šé‡åŠ›åè®¾è®¡è§„èŒƒã€‹GB 50287-2006
/// Ks = Î£R / Î£S = f(W - U) / (P + E)
/// </summary>
private double CalculateSlidingStabilityWithParameters(
    DamEntity damEntity, 
    double waterPressure, 
    AnalysisParameters parameters)
{
    // åä½“è‡ªé‡ (kN)
    double selfWeight = damEntity.Geometry.Volume * damEntity.MaterialProperties.Density;
    
    // è®¡ç®—æ‰¬å‹åŠ› (kN)
    double upliftForce = CalculateUpliftForce(damEntity, 
        parameters.UpstreamWaterLevel,
        parameters.DownstreamWaterLevel,
        parameters.UpliftReductionFactor,
        parameters.WaterDensity);
    
    // æœ‰æ•ˆæ³•å‘åŠ›ï¼šè‡ªé‡å‡å»æ‰¬å‹åŠ› (kN)
    double effectiveNormalForce = selfWeight - upliftForce;
    
    // åœ°éœ‡æƒ¯æ€§åŠ›ï¼ˆæ°´å¹³åˆ†é‡ï¼‰(kN)
    double seismicForceHorizontal = parameters.SeismicCoefficient * selfWeight;
    
    // æŠ—æ»‘åŠ›ï¼šæ‘©æ“¦ç³»æ•° Ã— æœ‰æ•ˆæ³•å‘åŠ› (kN)
    double resistingForce = damEntity.MaterialProperties.FrictionCoefficient * effectiveNormalForce;
    
    // æ»‘åŠ¨åŠ›ï¼šæ°´å¹³æ°´å‹åŠ› + åœ°éœ‡æƒ¯æ€§åŠ› (kN)
    double slidingForce = waterPressure + seismicForceHorizontal;
    
    // æŠ—æ»‘ç¨³å®šå®‰å…¨ç³»æ•°
    double safetyFactor = slidingForce > 0 ? resistingForce / slidingForce : double.MaxValue;
    
    return Math.Max(0, safetyFactor);
}
```

## ğŸ“ ç†è®ºä¾æ®ä¸å…¬å¼éªŒè¯

### æŠ—æ»‘ç¨³å®šåŸºæœ¬å…¬å¼

æ ¹æ®ã€Šé‡åŠ›åè®¾è®¡è§„èŒƒã€‹GB 50287-2006ï¼š

```
Ks = Î£R / Î£S = f(W - U) / (P + E)
```

å…¶ä¸­ï¼š
- **Ks** - æŠ—æ»‘ç¨³å®šå®‰å…¨ç³»æ•°
- **f** - ååŸºæ‘©æ“¦ç³»æ•°
- **W** - åä½“è‡ªé‡ (kN)
- **U** - æ‰¬å‹åŠ› (kN)  
- **P** - å‡€æ°´å‹åŠ› (kN)
- **E** - åœ°éœ‡æƒ¯æ€§åŠ› (kN)

### å„åŠ›é¡¹è®¡ç®—å…¬å¼

1. **åä½“è‡ªé‡**ï¼š`W = V Ã— Î³c`
2. **å‡€æ°´å‹åŠ›**ï¼š`P = 0.5 Ã— Î³w Ã— (Hâ‚Â² - Hâ‚‚Â²)`
3. **æ‰¬å‹åŠ›**ï¼š`U = Î± Ã— Î³w Ã— A Ã— HÌ„`
4. **åœ°éœ‡åŠ›**ï¼š`E = Î±h Ã— W`

## ğŸ”§ æ”¹è¿›å»ºè®®

### 1. æ¶æ„æ”¹è¿›

**å»ºè®®å¢åŠ å‚æ•°éªŒè¯**ï¼š
```csharp
// éªŒè¯æœ‰æ•ˆæ³•å‘åŠ›ä¸ä¸ºè´Ÿ
if (effectiveNormalForce <= 0)
{
    _logger.LogWarning("æœ‰æ•ˆæ³•å‘åŠ›ä¸ºè´Ÿå€¼ï¼Œæ‰¬å‹åŠ›è¿‡å¤§ï¼Œè®¾è®¡ä¸åˆç†");
    return 0.0; // æˆ–æŠ›å‡ºå¼‚å¸¸
}
```

**å»ºè®®å¢åŠ å•ä½æ£€æŸ¥**ï¼š
```csharp
// æ·»åŠ å•ä½éªŒè¯æ–¹æ³•
private void ValidateUnits(AnalysisParameters parameters)
{
    if (parameters.WaterDensity < 9.0 || parameters.WaterDensity > 10.0)
        _logger.LogWarning("æ°´é‡åº¦æ•°å€¼å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥å•ä½æ˜¯å¦ä¸ºkN/mÂ³");
}
```

### 2. æ¥å£æ”¹è¿›

**å»ºè®®ä¿®æ”¹æ¥å£æ–¹æ³•ç­¾å**ï¼š
```csharp
// åœ¨æ¥å£ä¸­å¢åŠ å¸¦å‚æ•°çš„é‡è½½æ–¹æ³•
double CalculateSlidingStability(DamEntity damEntity, AnalysisParameters parameters);
```

### 3. æµ‹è¯•ç”¨ä¾‹æ”¹è¿›

**å»ºè®®å¢åŠ è¾¹ç•Œæ¡ä»¶æµ‹è¯•**ï¼š
- æ‰¬å‹åŠ›å¤§äºè‡ªé‡çš„æƒ…å†µ
- æå°å®‰å…¨ç³»æ•°çš„å¤„ç†
- å•ä½è½¬æ¢çš„éªŒè¯æµ‹è¯•

## ğŸš¨ å®‰å…¨ç³»æ•°è¦æ±‚

æ ¹æ®è§„èŒƒè¦æ±‚ï¼š

| è·è½½ç»„åˆ | æŠ—æ»‘å®‰å…¨ç³»æ•° Ks |
|----------|------------------|
| åŸºæœ¬ç»„åˆ | â‰¥ 3.0 |
| ç‰¹æ®Šç»„åˆ | â‰¥ 2.5 |
| å¶ç„¶ç»„åˆ | â‰¥ 2.0 |

## ğŸ“Š è®¡ç®—ç¤ºä¾‹éªŒè¯

**å…¸å‹é‡åŠ›åå‚æ•°**ï¼š
- åé«˜ï¼š60mï¼Œåº•å®½ï¼š48mï¼Œåé•¿ï¼š100m
- æ··å‡åœŸé‡åº¦ï¼š24 kN/mÂ³ï¼Œæ‘©æ“¦ç³»æ•°ï¼š0.75
- ä¸Šæ¸¸æ°´ä½ï¼š58mï¼Œä¸‹æ¸¸æ°´ä½ï¼š5m

**ä¿®æ­£å‰åå¯¹æ¯”**ï¼š
- ä¿®æ­£å‰ï¼šé”™è¯¯åœ°å¿½ç•¥æ‰¬å‹åŠ›å½±å“ â†’ åå±é™©çš„é«˜å®‰å…¨ç³»æ•°
- ä¿®æ­£åï¼šæ­£ç¡®è€ƒè™‘æ‰¬å‹åŠ› â†’ çœŸå®çš„å®‰å…¨ç³»æ•°è¯„ä¼°

## ğŸ¯ æ€»ç»“

### å®¡æŸ¥ç»“è®º
ä»£ç ä¿®æ­£åå·²ç¬¦åˆã€Šé‡åŠ›åè®¾è®¡è§„èŒƒã€‹GB 50287-2006çš„è¦æ±‚ï¼Œè®¡ç®—å…¬å¼æ­£ç¡®ï¼Œå¯ä»¥ç”¨äºå®é™…å·¥ç¨‹åˆ†æã€‚

### å…³é”®ä¿®æ­£
1. âœ… æŠ—æ»‘ç¨³å®šå…¬å¼æ­£ç¡®å®ç°äº†æ‰¬å‹åŠ›çš„å½±å“
2. âœ… æ°´å‹åŠ›è®¡ç®—æŒ‰ç…§è§„èŒƒå…¬å¼å®ç°
3. âœ… å•ä½ç»Ÿä¸€ä¸ºå·¥ç¨‹å¸¸ç”¨çš„kNä½“ç³»
4. âœ… å¢åŠ äº†è¯¦ç»†çš„è®¡ç®—æ³¨é‡Šå’Œç†è®ºä¾æ®

### åç»­å»ºè®®
1. å®Œå–„å•å…ƒæµ‹è¯•ï¼Œè¦†ç›–å„ç§å·¥å†µ
2. å¢åŠ ä¸‰ç»´æ•ˆåº”çš„è€ƒè™‘ï¼ˆå¯¹äºé«˜åï¼‰
3. è€ƒè™‘æ¸—æµåˆ†æå¯¹æ‰¬å‹åŠ›çš„å½±å“
4. å¢åŠ å›¾å½¢åŒ–çš„åŠ›å­¦åˆ†æç»“æœå±•ç¤º

---

**å®¡æŸ¥äººå‘˜**ï¼šAIä»£ç å®¡æŸ¥ä¸“å®¶  
**å®¡æŸ¥å®Œæˆæ—¶é—´**ï¼š2024å¹´  
**å»ºè®®å¤æŸ¥å‘¨æœŸ**ï¼šä»£ç å˜æ›´å 